{% extends "base.html" %}
{% load static %}
{% block content %}
<link rel="stylesheet" href="{% static 'dashboard/css/notifications.css' %}">

<div class="notifications-page">
  <header class="notifications-header">
    <h1>Notifications</h1>
    <form id="markAllForm" method="post">
      {% csrf_token %}
      <input type="hidden" name="action" value="mark_all_read">
      <button type="submit" class="btn-mark-read">Mark All as Read</button>
    </form>
  </header>

  <!-- Tabs -->
  <nav class="notifications-tabs">
    <button class="tab active" data-filter="all" type="button">All</button>
    <button class="tab" data-filter="jobs" type="button">Jobs</button>
    <button class="tab" data-filter="system" type="button">System</button>
    <button class="tab" data-filter="admin" type="button">Admin</button>
    <button class="tab" data-filter="tips" type="button">Tips</button>
  </nav>

  <!-- Notification List -->
  <section class="notifications-list" id="notificationsList">
    {% if notifications %}
      {% for n in notifications %}
        {% with type_tag="jobs" %}
          {% if not n.job and not n.application %}
            {% with type_tag="system" %}{% endwith %}
          {% endif %}
        {% endwith %}
        <article class="notification-card {% if not n.is_read %}unread{% endif %}" data-type="{% if n.job or n.application %}jobs{% else %}system{% endif %}">
          <div class="icon">
            {% if n.job or n.application %}üíº{% else %}‚ö†Ô∏è{% endif %}
          </div>
          <div class="content">
            <h3>{{ n.verb|default:"Update"|capfirst }}</h3>
            <p>{{ n.message }}</p>
            <time>{{ n.created_at|timesince }} ago</time>
          </div>
          <div class="actions">
            {% if n.url %}
              <a href="{{ n.url }}" class="btn-action">View</a>
            {% endif %}
          </div>
        </article>
      {% endfor %}
    {% else %}
      <!-- Example empty state -->
      <p class="empty">No notifications yet.</p>
    {% endif %}
  </section>
</div>

<script src="{% static 'dashboard/js/notifications.js' %}"></script>
{% endblock %}
