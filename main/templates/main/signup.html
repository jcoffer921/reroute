{% extends 'base.html' %}

{% block title %}ReRoute | Sign Up{% endblock %}

{% block content %}
<div class="signup-container">
    <h2>Create Your Account</h2>

    <!-- Show form-level and field-specific errors -->
    {% if user_form.errors or profile_form.errors %}
        <div class="form-errors">
            <ul>
                {% for field in user_form %}
                    {% for error in field.errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                {% endfor %}
                {% for field in profile_form %}
                    {% for error in field.errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                {% endfor %}
                {% for error in user_form.non_field_errors %}
                    <li>{{ error }}</li>
                {% endfor %}
                {% for error in profile_form.non_field_errors %}
                    <li>{{ error }}</li>
                {% endfor %}
            </ul>
        </div>
    {% endif %}

    <form method="POST">
        {% csrf_token %}
        {{ user_form.as_p }}
        <button type="submit">Create Account</button>
    </form>

</div>

<!-- JavaScript Password Strength Checker -->
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const passwordInput = document.querySelector('#id_password');
        const strengthText = document.getElementById('password-strength');

        if (passwordInput) {
            passwordInput.addEventListener('input', function () {
                const val = passwordInput.value;
                let strength = 0;

                if (val.length >= 8) strength++;
                if (/[A-Z]/.test(val)) strength++;
                if (/[a-z]/.test(val)) strength++;
                if (/\d/.test(val)) strength++;
                if (/[!@#$%^&*(),.?":{}|<>]/.test(val)) strength++;

                switch (strength) {
                    case 0:
                    case 1:
                        strengthText.textContent = 'Very weak';
                        strengthText.style.color = 'red';
                        break;
                    case 2:
                    case 3:
                        strengthText.textContent = 'Medium strength';
                        strengthText.style.color = 'orange';
                        break;
                    case 4:
                    case 5:
                        strengthText.textContent = 'Strong password';
                        strengthText.style.color = 'green';
                        break;
                }
            });
        }
    });
</script>
{% endblock %}
